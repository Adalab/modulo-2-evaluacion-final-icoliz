"use strict";const searchInput=document.querySelector(".js_input"),searchBtn=document.querySelector(".js_searchBtn"),resetBtn=document.querySelector(".js_resetBtn"),movieList=document.querySelector(".js_movieList"),favMovies=document.querySelector(".js_favMovies");let dataAnime=[],dataFavorites=[];function findMovie(){const e=searchInput.value;fetch("https://api.jikan.moe/v3/search/anime?q="+e).then(e=>e.json()).then(e=>{dataAnime=e.results,void 0!==dataAnime?renderAnimeList():renderMessage()})}function renderAnimeList(){movieList.innerHTML="";for(const e of dataAnime){0!==dataFavorites.filter(t=>t.mal_id===e.mal_id).length?movieList.innerHTML+=`<li class="js_resultsLi movie faved" data-id="${e.mal_id}"><i class="fas fa-star js_star highlighted"></i><img src=${e.image_url} alt="Cover image of ${e.title}" class="movie__img highlighted">\n        <h3 class="movie__title">${e.title}</h3>\n        </li>`:movieList.innerHTML+=`<li class="js_resultsLi movie" data-id="${e.mal_id}"><i class="fas fa-star js_star"></i><img src=${e.image_url} alt="Cover image of ${e.title}" class="movie__img js_animeTitle">\n        <h3 class="movie__title">${e.title}</h3>\n        </li>`}addFavorite()}function renderMessage(){movieList.innerHTML='<p class="error-msg">No hay resultados para esta b√∫squeda, por favor introduzca otro nombre</p>'}function handleClickSearch(e){e.preventDefault(),""===searchInput.value?movieList.innerHTML='<p class="error-msg">Por favor, introduzca el nombre de la serie</p>':findMovie()}function addFavorite(){const e=document.querySelectorAll(".js_resultsLi");for(const t of e)t.addEventListener("click",handleClickFavorite)}function handleClickFavorite(e){const t=e.currentTarget,i=e.currentTarget.childNodes[0],a=e.currentTarget.childNodes[3],s=parseInt(e.currentTarget.dataset.id),r=dataAnime.find(e=>e.mal_id===s),n=dataFavorites.find(e=>e.mal_id===s);if(void 0===n)t.classList.add("faved"),i.classList.add("highlighted"),a.classList.add("highlighted"),dataFavorites.push(r);else{t.classList.remove("faved"),i.classList.remove("highlighted"),a.classList.remove("highlighted");const e=dataFavorites.indexOf(n);dataFavorites.splice(e,1)}saveInLS(),renderFavorites()}function renderFavorites(){favMovies.innerHTML="";for(const e of dataFavorites)favMovies.innerHTML+=`<li class="js_favoritesLi favmovie" data-id="${e.mal_id}">\n    <img src=${e.image_url} alt="Cover image of ${e.title}" class="favmovie__img">\n    <div class="favmovie-container"><h3 class="favmovie__title">${e.title}</h3>\n    <p class="favmovie__synopsis">${e.synopsis}</p></div>\n    <i class="fas fa-times-circle js_closeBtn"></i>\n    </li>`;dataFavorites.length>=1&&(favMovies.innerHTML+='<button class="js_deleteAllFavs delete-button"><i class="far fa-trash-alt"></i>Borrar todo</button>',deleteAllFavorites()),removeFavorite()}function saveInLS(){const e=JSON.stringify(dataFavorites);localStorage.setItem("favMovies",e)}function getFromLS(){const e=localStorage.getItem("favMovies");null!==e&&(dataFavorites=JSON.parse(e)),renderFavorites()}function handleClickReset(){searchInput.value=""}function removeFavorite(){const e=document.querySelectorAll(".js_closeBtn");for(const t of e)t.addEventListener("click",handleClickRemove)}function handleClickRemove(e){const t=parseInt(e.currentTarget.parentElement.dataset.id),i=dataFavorites.find(e=>e.mal_id===t),a=dataFavorites.indexOf(i);dataFavorites.splice(a,1),saveInLS(),renderFavorites(),renderAnimeList()}function deleteAllFavorites(){document.querySelector(".js_deleteAllFavs").addEventListener("click",handleClickDeleteAllFavs)}function handleClickDeleteAllFavs(){dataFavorites=[],saveInLS(),renderFavorites(),renderAnimeList()}searchBtn.addEventListener("click",handleClickSearch),getFromLS(),resetBtn.addEventListener("click",handleClickReset);